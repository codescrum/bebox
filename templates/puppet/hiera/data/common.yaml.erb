<% if self.environment.name == 'vagrant' %>
nginx::nginx_vhosts:
  '<%= self.environment.project.name %>':
    ensure: 'present'
    listen_port:  3000
    use_default_location: false
    www_root: '/home/pname/pname/public'
    access_log: '/var/log/nginx/puppet_access.log'
    error_log: '/var/log/nginx/puppet_error.log'
rbenv::install:
    user:  '<%= self.environment.project.name %>'
    group:  '<%= self.environment.project.name %>'
    home:  '/home/<%= self.environment.project.name %>'
rbenv::compile:
    "2.1.0":
        user:  "<%= self.environment.project.name %>"
        home:  "/home/<%= self.environment.project.name %>"
        global:  true
rbenv::gem:
    'rails':
        user:  '<%= self.environment.project.name %>'
        ruby:  '2.1.0'
redis::install:
    redis_version: '2.8.8'
    redis_build_dir: '/opt'
    redis_install_dir: '/usr/bin'
redis::server:
    'instance1':
        redis_memory:  '112m'
        redis_ip:  '0.0.0.0'
        redis_port:  6380
        redis_mempolicy:  'allkeys-lru'
        redis_timeout:  0
        redis_nr_dbs:  16
        redis_loglevel:  'notice'
        running:  true
        enabled:  true
mysql::server:
  root_password: 'strongpassword'
  override_options:
    'mysqld':
        'max_connections': '1024'
postgresql::server:
    listen:
        - '0.0.0.0'
    port: 5432
    version: '9.2'
mongodb::mongod:
    'my_mongod_instance1':
        mongod_instance: 'mongodb1'
        mongod_add_options:
            - 'fastsync = true'
            - 'slowms = 50'
newrelic:
    license_key: ''
    use_latest: true
<% else %>
nginx::nginx_vhosts:
  '<%= self.environment.project.name %>':
    ensure: 'present'
    listen_port:  80
    use_default_location: false
    www_root: '<%= "/home/#{self.environment.project.name}/code/current" %>'
    access_log: '<%= "/home/#{self.environment.project.name}/code/current/log/access.log" %>'
    error_log: '<%= "/home/#{self.environment.project.name}/code/current/log/error.log" %>'
<% end %>