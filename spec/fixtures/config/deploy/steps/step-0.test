before 'puppet:bundle_modules', 'puppet:download_modules'

namespace :puppet do
  task :download_modules do
    modules_path = "#{current_path}/steps/#{step_dir}/modules"
    # Download stdlib module
    run "cd #{modules_path} && wget -qO- https://forgeapi.puppetlabs.com/v3/files/puppetlabs-stdlib-4.2.2.tar.gz | tar xvz && mv puppetlabs-stdlib-4.2.2 stdlib"
    # Download rbenv module
    run "cd #{modules_path} && wget -qO- https://forgeapi.puppetlabs.com/v3/files/alup-rbenv-1.2.0.tar.gz | tar xvz && mv alup-rbenv-1.2.0 rbenv"
    # Download sudo module
    run "cd #{modules_path} && wget -qO- https://forgeapi.puppetlabs.com/v3/files/saz-sudo-3.0.6.tar.gz | tar xvz && mv saz-sudo-3.0.6 sudo"
  end
end